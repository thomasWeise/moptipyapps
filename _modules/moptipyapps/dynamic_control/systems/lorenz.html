<!doctype html><html data-content_root=../../../../ lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0"name=viewport><title>moptipyapps.dynamic_control.systems.lorenz — moptipyapps 0.8.68 documentation</title><link href="../../../../_static/pygments.css?v=b86133f3"rel=stylesheet><link href="../../../../_static/bizstyle.css?v=5283bb3d"rel=stylesheet><script src="../../../../_static/documentation_options.js?v=f8800668"></script><script src="../../../../_static/doctools.js?v=9bcbadda"></script><script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script><script src=../../../../_static/bizstyle.js></script><link href=https://thomasweise.github.io/moptipyapps/_modules/moptipyapps/dynamic_control/systems/lorenz.html rel=canonical><link href=../../../../genindex.html rel=index title=Index><link href=../../../../search.html rel=search title=Search><meta content="width=device-width,initial-scale=1.0"name=viewport><body><div aria-label=Related class=related role=navigation><h3>Navigation</h3><ul><li class=right style=margin-right:10px><a title="General Index"accesskey=I href=../../../../genindex.html>index</a><li class=right><a title="Python Module Index"href=../../../../py-modindex.html>modules</a> |<li class="nav-item nav-item-0"><a href=../../../../index.html>moptipyapps 0.8.68 documentation</a> »<li class="nav-item nav-item-1"><a accesskey=U href=../../../index.html>Module code</a> »<li class="nav-item nav-item-this"><a href>moptipyapps.dynamic_control.systems.lorenz</a></ul></div><div class=document><div class=documentwrapper><div class=bodywrapper><div class=body role=main><h1>Source code for moptipyapps.dynamic_control.systems.lorenz</h1><div class=highlight><pre>
<span></span><span class=sd>"""</span>
<span class=sd>The three-dimensional Lorenz system.</span>

<span class=sd>The initial starting point of the work here were conversations with</span>
<span class=sd>Prof. Dr. Bernd NOACK and Guy Yoslan CORNEJO MACEDA of the Harbin Institute</span>
<span class=sd>of Technology in Shenzhen, China (哈尔滨工业大学(深圳)) as well as the</span>
<span class=sd>following two MSc theses and book:</span>

<span class=sd>1. Yuxiang LI (李宇翔). Jet Mixing Enhancement using Deep Reinforcement</span>
<span class=sd>   Learning (基于深度强化学习的射流混合增强控制). MSc Thesis. Harbin Institute</span>
<span class=sd>   of Technology in Shenzhen, China (哈尔滨工业大学(深圳)).</span>
<span class=sd>   January 2023.</span>
<span class=sd>2. Wei SUN (孙伟). Wake Control of 1-2-3 Fluidic Pinball using Deep</span>
<span class=sd>   Reinforcement Learning (基于深度强化学习方法的 1-2-3 流体弹球尾流控制).</span>
<span class=sd>   MSc Thesis. Harbin Institute of Technology in Shenzhen, China</span>
<span class=sd>   (哈尔滨工业大学(深圳)). January 2023.</span>
<span class=sd>3. Guy Yoslan CORNEJO MACEDA, François LUSSEYRAN, and Bernd R. NOACK.</span>
<span class=sd>   xMLC: A Toolkit for Machine Learning Control, First Edition.</span>
<span class=sd>   Machine Learning Tools in Fluid Mechanics, Vol 2.</span>
<span class=sd>   Shenzhen & Paris; Universitätsbibliothek der Technischen Universität</span>
<span class=sd>   Braunschweig. 2022 https://doi.org/10.24355/dbbs.084-202208220937-0</span>
<span class=sd>"""</span>

<span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Final</span>

<span class=kn>import</span><span class=w> </span><span class=nn>numba</span>  <span class=c1># type: ignore</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>pycommons.types</span><span class=w> </span><span class=kn>import</span> <span class=n>check_int_range</span>

<span class=kn>from</span><span class=w> </span><span class=nn>moptipyapps.dynamic_control.starting_points</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
    <span class=n>make_interesting_starting_points</span><span class=p>,</span>
<span class=p>)</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipyapps.dynamic_control.system</span><span class=w> </span><span class=kn>import</span> <span class=n>System</span>


<span class=nd>@numba</span><span class=o>.</span><span class=n>njit</span><span class=p>(</span><span class=n>cache</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>inline</span><span class=o>=</span><span class=s2>"always"</span><span class=p>,</span> <span class=n>fastmath</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>boundscheck</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=k>def</span><span class=w> </span><span class=nf>__lorenz_equations</span><span class=p>(</span><span class=n>state</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>_</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
                       <span class=n>control</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>out</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-></span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>"""</span>
<span class=sd>    Compute the differential equations of a controlled 3D Lorenz system.</span>

<span class=sd>    :param state: the state of the system</span>
<span class=sd>    :param _: the time index, which is ignored</span>
<span class=sd>    :param control: the output of the controller</span>
<span class=sd>    :param out: the differential, i.e., the output of this function</span>
<span class=sd>    """</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
    <span class=n>y</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
    <span class=n>z</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>

    <span class=c1># compute the differential system</span>
    <span class=n>out</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mf>10.0</span> <span class=o>*</span> <span class=p>(</span><span class=n>y</span> <span class=o>-</span> <span class=n>x</span><span class=p>)</span>
    <span class=n>out</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mf>28.0</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>y</span> <span class=o>-</span> <span class=p>(</span><span class=n>x</span> <span class=o>*</span> <span class=n>z</span><span class=p>)</span> <span class=o>+</span> <span class=n>control</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
    <span class=n>out</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span> <span class=o>*</span> <span class=n>y</span> <span class=o>-</span> <span class=p>(</span><span class=mf>2.6666666666666665</span> <span class=o>*</span> <span class=n>z</span><span class=p>)</span>


<div class=viewcode-block id=make_lorenz>
<a class=viewcode-back href=../../../../moptipyapps.dynamic_control.systems.html#moptipyapps.dynamic_control.systems.lorenz.make_lorenz>[docs]</a>
<span class=k>def</span><span class=w> </span><span class=nf>make_lorenz</span><span class=p>(</span><span class=n>n_points</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-></span> <span class=n>System</span><span class=p>:</span>
<span class=w>    </span><span class=sd>"""</span>
<span class=sd>    Create the Lorenz system.</span>

<span class=sd>    :param n_points: the number of training points</span>
<span class=sd>    :return: the Lorenz system</span>
<span class=sd>    """</span>
    <span class=n>check_int_range</span><span class=p>(</span><span class=n>n_points</span><span class=p>,</span> <span class=s2>"n_points"</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1_000</span><span class=p>)</span>
    <span class=n>tests</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> \
        <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=o>-</span><span class=mf>1.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>],</span> <span class=p>[</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>22.0</span><span class=p>]],</span> <span class=nb>float</span><span class=p>)</span>
    <span class=c1># similar to training = make_interesting_starting_points(111, tests)</span>
    <span class=n>training</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
        <span class=p>[[</span><span class=o>-</span><span class=mf>2.31837616e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.24709723e-2</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.28671997e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>5.24425115e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>4.36886027e-2</span><span class=p>,</span> <span class=mf>1.23705573e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>3.34157047e-1</span><span class=p>,</span> <span class=mf>6.24361532e-1</span><span class=p>,</span> <span class=mf>3.95015241e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>4.55212674e-2</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.84129335e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>4.45366280e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>3.63753119e-1</span><span class=p>,</span> <span class=mf>5.10336447e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.19737193</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>2.09587174e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>6.89638430e-1</span><span class=p>,</span> <span class=mf>1.45278120</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.83653628</span><span class=p>,</span> <span class=mf>3.19596142e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>3.23809729e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.15939504</span><span class=p>,</span> <span class=mf>1.50893034</span><span class=p>,</span> <span class=mf>1.02697020</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.97903772</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.41455814</span><span class=p>,</span> <span class=mf>1.27529901e-2</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>8.62639452e-1</span><span class=p>,</span> <span class=mf>2.43142041</span><span class=p>,</span> <span class=o>-</span><span class=mf>8.06154187e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.69664567</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.39320251</span><span class=p>,</span> <span class=o>-</span><span class=mf>4.83774211e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.73331044</span><span class=p>,</span> <span class=mf>8.57709170e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.52110281</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>5.33078125e-2</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.31842985</span><span class=p>,</span> <span class=o>-</span><span class=mf>3.25664933</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>8.07769100e-2</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.97754587</span><span class=p>,</span> <span class=mf>2.33390990</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.35072569</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.43006329e-1</span><span class=p>,</span> <span class=mf>3.30026821</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>4.03232742</span><span class=p>,</span> <span class=o>-</span><span class=mf>8.31922303e-1</span><span class=p>,</span> <span class=mf>1.32332254</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>3.24522964</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.89918862e-2</span><span class=p>,</span> <span class=o>-</span><span class=mf>3.25299734</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.55208382</span><span class=p>,</span> <span class=mf>4.52665580</span><span class=p>,</span> <span class=mf>8.78256040e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.22089300</span><span class=p>,</span> <span class=o>-</span><span class=mf>4.58186003</span><span class=p>,</span> <span class=o>-</span><span class=mf>6.69524512e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.00280557</span><span class=p>,</span> <span class=mf>2.54311243</span><span class=p>,</span> <span class=o>-</span><span class=mf>4.66372240</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>4.04118291</span><span class=p>,</span> <span class=mf>3.70295973</span><span class=p>,</span> <span class=mf>1.47501504</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>5.67173423</span><span class=p>,</span> <span class=mf>1.44565665</span><span class=p>,</span> <span class=mf>1.04964605</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>2.59523889</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.26245489</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.05406409</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.94504196</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.45896263</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.23085552</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>3.28897946</span><span class=p>,</span> <span class=mf>4.83504710</span><span class=p>,</span> <span class=o>-</span><span class=mf>3.38620915</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>2.58817813</span><span class=p>,</span> <span class=o>-</span><span class=mf>6.25659365e-1</span><span class=p>,</span> <span class=mf>6.50364050</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>5.72357009</span><span class=p>,</span> <span class=o>-</span><span class=mf>3.49153015</span><span class=p>,</span> <span class=mf>2.88262233</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>5.22299795</span><span class=p>,</span> <span class=mf>4.53644041</span><span class=p>,</span> <span class=o>-</span><span class=mf>3.06899979</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>4.87825184</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.29004044</span><span class=p>,</span> <span class=mf>3.10808896</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>4.27501083</span><span class=p>,</span> <span class=mf>3.63860787</span><span class=p>,</span> <span class=mf>5.85126863</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>8.34000452</span><span class=p>,</span> <span class=mf>4.25671605e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>6.87181237e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.08540415</span><span class=p>,</span> <span class=mf>8.10559431</span><span class=p>,</span> <span class=mf>2.81655916</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.94788569</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.30894243</span><span class=p>,</span> <span class=mf>6.89792956</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>8.45383153</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.55041688</span><span class=p>,</span> <span class=o>-</span><span class=mf>3.25336920</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.03169607</span><span class=p>,</span> <span class=mf>1.91837732</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.20608115</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>6.59584225</span><span class=p>,</span> <span class=o>-</span><span class=mf>4.08814508</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.87073907</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>5.15768660e-2</span><span class=p>,</span> <span class=o>-</span><span class=mf>7.31844351</span><span class=p>,</span> <span class=o>-</span><span class=mf>6.81576316</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.10412724</span><span class=p>,</span> <span class=mf>9.35404100</span><span class=p>,</span> <span class=o>-</span><span class=mf>4.09623004</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>9.24919988e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.04001359e+1</span><span class=p>,</span> <span class=mf>1.45033454</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>8.42728582</span><span class=p>,</span> <span class=mf>4.69942357</span><span class=p>,</span> <span class=mf>4.87746425</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>6.56849521</span><span class=p>,</span> <span class=o>-</span><span class=mf>8.92524514</span><span class=p>,</span> <span class=mf>7.73503710e-2</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>7.84621150</span><span class=p>,</span> <span class=mf>3.63654240</span><span class=p>,</span> <span class=o>-</span><span class=mf>7.35441923</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.76374875</span><span class=p>,</span> <span class=mf>5.20695220</span><span class=p>,</span> <span class=mf>1.02402030e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>6.59956499</span><span class=p>,</span> <span class=mf>2.63679539</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.53593460</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.11970782e+1</span><span class=p>,</span> <span class=mf>4.34954429e-1</span><span class=p>,</span> <span class=mf>4.73069196</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>8.21196486</span><span class=p>,</span> <span class=mf>9.31990914</span><span class=p>,</span> <span class=mf>5.42613335e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>6.86424196</span><span class=p>,</span> <span class=mf>1.06609923e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>7.81891961e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>4.09122371</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.09173842</span><span class=p>,</span> <span class=mf>1.12099315e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.12617383e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>3.36092053</span><span class=p>,</span> <span class=mf>6.10660311</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>4.40559872</span><span class=p>,</span> <span class=mf>1.77756117e-1</span><span class=p>,</span> <span class=mf>1.27751719e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>8.84888642</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.05672816e+1</span><span class=p>,</span> <span class=mf>2.33623289e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>3.10452705</span><span class=p>,</span> <span class=mf>1.18665218e+1</span><span class=p>,</span> <span class=mf>6.86275419</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>7.72028081</span><span class=p>,</span> <span class=o>-</span><span class=mf>7.37696538</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.54979561</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>2.05792588</span><span class=p>,</span> <span class=o>-</span><span class=mf>3.26013517</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.40774520e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.43317322e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.67395566</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.90739935</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>9.70967854</span><span class=p>,</span> <span class=o>-</span><span class=mf>7.60857398</span><span class=p>,</span> <span class=mf>8.77170340</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.33595404e+1</span><span class=p>,</span> <span class=mf>5.64205226</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.20159173</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.84184161</span><span class=p>,</span> <span class=mf>9.60079349</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.22556406e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.45763613e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>6.18659546</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.88994719</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>3.57766009</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.50015844e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.01626682</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>9.17805707e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.39139085e+1</span><span class=p>,</span> <span class=mf>8.79834996</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.06480184e+1</span><span class=p>,</span> <span class=mf>6.70055614</span><span class=p>,</span> <span class=mf>1.10706193e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.56128381e+1</span><span class=p>,</span> <span class=mf>6.46573099</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.09815734</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>9.87640379</span><span class=p>,</span> <span class=o>-</span><span class=mf>8.30988969</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.15173542e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>9.95414070</span><span class=p>,</span> <span class=mf>4.28155228</span><span class=p>,</span> <span class=mf>1.38294971e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>6.89378192</span><span class=p>,</span> <span class=mf>1.36522586e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.18334631</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.76686982</span><span class=p>,</span> <span class=mf>1.79486554e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.63796984</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>7.05633216</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.36984415</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.69160748e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>6.42179549</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.65952281e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.58478539</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>7.41816999</span><span class=p>,</span> <span class=mf>1.54645465e+1</span><span class=p>,</span> <span class=mf>7.98777508</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>8.42681552</span><span class=p>,</span> <span class=mf>4.69511699</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.65901139e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>9.78324506</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.39304328e+1</span><span class=p>,</span> <span class=mf>9.43216455</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.94440370e+1</span><span class=p>,</span> <span class=mf>2.31090199</span><span class=p>,</span> <span class=mf>2.43252766</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>3.15058476</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.05446229</span><span class=p>,</span> <span class=mf>1.75544337e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.06459182e+1</span><span class=p>,</span> <span class=mf>1.47218781e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>8.99355553</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.22190707e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.64529457e+1</span><span class=p>,</span> <span class=mf>1.40712921</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.90636227e+1</span><span class=p>,</span> <span class=mf>2.16964624</span><span class=p>,</span> <span class=mf>8.06436472</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>2.34494082</span><span class=p>,</span> <span class=mf>1.15135585e+1</span><span class=p>,</span> <span class=mf>1.75050371e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.78508769e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.19686564</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.15098756e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.31504343e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.38773263e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.65813076e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.50443571e+1</span><span class=p>,</span> <span class=mf>1.49229413e+1</span><span class=p>,</span> <span class=mf>5.50536850</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.79414521e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>6.05704638e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.29993027e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.90893740e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.14789797e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.66981417</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.09824863e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>4.56662192</span><span class=p>,</span> <span class=mf>1.93398756e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.27613899e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.31578801</span><span class=p>,</span> <span class=mf>1.89639329e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.06885845</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.27641276e+1</span><span class=p>,</span> <span class=mf>4.58167139</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.78853615e+1</span><span class=p>,</span> <span class=mf>1.41595978e+1</span><span class=p>,</span> <span class=mf>5.70950161</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.03291895e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>8.39726474</span><span class=p>,</span> <span class=mf>9.05394871</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.93958349</span><span class=p>,</span> <span class=mf>7.21737732</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.28657560e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.90522968</span><span class=p>,</span> <span class=mf>2.16902183e+1</span><span class=p>,</span> <span class=mf>1.08479166e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.45272901e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.63102458e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.13106168e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.87965003e+1</span><span class=p>,</span> <span class=mf>1.38830549e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>8.50402100</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>8.67486188</span><span class=p>,</span> <span class=mf>2.35641803e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.16532740</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>2.08371573e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.29064237</span><span class=p>,</span> <span class=mf>1.11821538e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>7.40930680</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.51574155</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.39589341e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.55046343e+1</span><span class=p>,</span> <span class=mf>8.72083349</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.88907194e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>9.62045596</span><span class=p>,</span> <span class=mf>1.31513890e+1</span><span class=p>,</span> <span class=mf>2.05400575e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>8.89447741e-1</span><span class=p>,</span> <span class=mf>2.16932725e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.51744310e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.20103755e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.90498725e+1</span><span class=p>,</span> <span class=mf>1.44533139e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.47165331</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.52776137e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.24753127</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.43672486e+1</span><span class=p>,</span> <span class=mf>1.09659183e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>5.59054774</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.05756254e+1</span><span class=p>,</span> <span class=mf>2.54424857e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.67114390e-1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.36887388e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.40892890e+1</span><span class=p>,</span> <span class=mf>2.72043969</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>2.80062395e+1</span><span class=p>,</span> <span class=mf>8.56852541e-1</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.26177776</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>5.19799304</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.81696491e+1</span><span class=p>,</span> <span class=mf>2.11734080e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.40714873e+1</span><span class=p>,</span> <span class=mf>6.51484929</span><span class=p>,</span> <span class=mf>1.41068791e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>1.09672511e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>8.86272444</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.52510743e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.66896882e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.74937806e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.63577116e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=mf>2.72013507e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.05512055e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>4.09451211</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.68644649e+1</span><span class=p>,</span> <span class=mf>1.27734462e+1</span><span class=p>,</span> <span class=mf>2.08910298e+1</span><span class=p>],</span>
         <span class=p>[</span><span class=o>-</span><span class=mf>1.36658517e+1</span><span class=p>,</span> <span class=mf>1.36662584e+1</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.29484206e+1</span><span class=p>]])</span> \
        <span class=k>if</span> <span class=n>n_points</span> <span class=o>==</span> <span class=mi>111</span> <span class=k>else</span> <span class=p>(</span>
            <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=o>-</span><span class=mf>0.75900911</span><span class=p>,</span> <span class=mf>3.40732601</span><span class=p>,</span> <span class=o>-</span><span class=mf>6.63879075</span><span class=p>],</span>
                      <span class=p>[</span><span class=mf>10.95019756</span><span class=p>,</span> <span class=o>-</span><span class=mf>9.9362743</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.53014984</span><span class=p>],</span>
                      <span class=p>[</span><span class=o>-</span><span class=mf>17.32322703</span><span class=p>,</span> <span class=o>-</span><span class=mf>10.12101153</span><span class=p>,</span> <span class=o>-</span><span class=mf>10.18854763</span><span class=p>],</span>
                      <span class=p>[</span><span class=mf>13.282736</span><span class=p>,</span> <span class=mf>14.93163678</span><span class=p>,</span> <span class=o>-</span><span class=mf>22.37782999</span><span class=p>]])</span>
            <span class=k>if</span> <span class=n>n_points</span> <span class=o>==</span> <span class=mi>4</span> <span class=k>else</span> <span class=n>make_interesting_starting_points</span><span class=p>(</span>
                <span class=n>n_points</span><span class=p>,</span> <span class=n>tests</span><span class=p>))</span>

    <span class=n>lorenz</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=n>System</span><span class=p>]</span> <span class=o>=</span> <span class=n>System</span><span class=p>(</span>
        <span class=s2>"lorenz"</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>tests</span><span class=p>,</span> <span class=n>training</span><span class=p>,</span> <span class=mi>5000</span><span class=p>,</span> <span class=mf>50.0</span><span class=p>,</span> <span class=mi>5000</span><span class=p>,</span> <span class=mf>50.0</span><span class=p>,</span>
        <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>training</span><span class=p>)</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>tests</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span>
    <span class=n>lorenz</span><span class=o>.</span><span class=n>equations</span> <span class=o>=</span> <span class=n>__lorenz_equations</span>  <span class=c1># type: ignore</span>
    <span class=k>return</span> <span class=n>lorenz</span></div>



<span class=c1>#: The Lorenz system with 111 training points.</span>
<span class=n>LORENZ_111</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=n>System</span><span class=p>]</span> <span class=o>=</span> <span class=n>make_lorenz</span><span class=p>(</span><span class=mi>111</span><span class=p>)</span>

<span class=c1>#: The Lorenz system with 4 training points.</span>
<span class=n>LORENZ_4</span><span class=p>:</span> <span class=n>Final</span><span class=p>[</span><span class=n>System</span><span class=p>]</span> <span class=o>=</span> <span class=n>make_lorenz</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</pre></div><div class=clearer></div></div></div></div><div aria-label=Main class=sphinxsidebar role=navigation><div class=sphinxsidebarwrapper><search id=searchbox role=search style=display:none> <h3 id=searchlabel>Quick search</h3> <div class=searchformwrapper><form action=../../../../search.html class=search><input aria-labelledby=searchlabel autocapitalize=off autocomplete=off autocorrect=off name=q spellcheck=false><input type=submit value=Go></form></div> </search><script>document.getElementById(`searchbox`).style.display=`block`</script></div></div><div class=clearer></div></div><div aria-label=Related class=related role=navigation><h3>Navigation</h3><ul><li class=right style=margin-right:10px><a title="General Index"href=../../../../genindex.html>index</a><li class=right><a title="Python Module Index"href=../../../../py-modindex.html>modules</a> |<li class="nav-item nav-item-0"><a href=../../../../index.html>moptipyapps 0.8.68 documentation</a> »<li class="nav-item nav-item-1"><a href=../../../index.html>Module code</a> »<li class="nav-item nav-item-this"><a href>moptipyapps.dynamic_control.systems.lorenz</a></ul></div><div class=footer role=contentinfo>© Copyright 2023-2025, Thomas Weise.</div>
